(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{399:function(s,a,n){"use strict";n.r(a);var t=n(42),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"docker-命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-命令"}},[s._v("#")]),s._v(" docker 命令")]),s._v(" "),n("p",[s._v("docker-compose 国内安装镜像")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -L https://get.daocloud.io/docker/compose/releases/download/1.24.0/docker-compose-"),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -s"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("-"),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -m"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/local/bin/docker-compose\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[s._v("#")]),s._v(" 启动")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" docker start\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\nsystemctl start docker\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h2",{attrs:{id:"镜像-image"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#镜像-image"}},[s._v("#")]),s._v(" 镜像 image")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看本机所有镜像")]),s._v("\ndocker image "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除镜像")]),s._v("\ndocker image "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像名称"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拉取镜像 docker image pull [library/]hello-world")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# library 为默认分组，可以忽略")]),s._v("\ndocker image pull "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像名称"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过 Dockerfile 文件创建 image")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker image build -t kaige:0.0.1 ./home")]),s._v("\ndocker image build -t "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像名称"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("版本号默认latest"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Dockerfile文件所在目录"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("h2",{attrs:{id:"发布-image"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#发布-image"}},[s._v("#")]),s._v(" 发布 image")]),s._v(" "),n("p",[s._v("去 "),n("a",{attrs:{href:"hub.docker.com"}},[s._v("hub.docker.com")]),s._v(" 或 "),n("a",{attrs:{href:"cloud.docker.com"}},[s._v("cloud.docker.com")]),s._v(" 注册一个账户, 使用如下命令登陆:")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker login\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("然后执行如下命令给镜像打 tag:")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker image tag hello:0.0.1 kaige/hello:0.0.1")]),s._v("\ndocker image tag "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像名称"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("username"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("repository"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("tag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者重新构建 image")]),s._v("\ndocker image build -t "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("username"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("repository"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("tag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Dockerfile文件所在目录"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("最后执行如下命令发布：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker image push "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("username"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("repository"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("tag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"容器-container"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#容器-container"}},[s._v("#")]),s._v(" 容器 container")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看本机正在运行的容器")]),s._v("\ndocker container "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看本机所有容器")]),s._v("\ndocker container "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" --all\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建一个容器 (每执行一次都会生成一个容器文件)")]),s._v("\ndocker container run "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像名称"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("运行 "),n("code",[s._v("image")]),s._v(" 文件会生成一个容器实例，这个"),n("strong",[s._v("容器实例")]),s._v("也是一个文件，因此容易一旦生成，\n会同时存在 "),n("strong",[s._v("image 文件")]),s._v("和"),n("strong",[s._v("容器文件")])]),s._v(" "),n("blockquote",[n("p",[n("code",[s._v("const 容器文件 = new image()")])])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --rm 参数表示关闭终止容器时，自动删除容器文件")]),s._v("\ndocker container run --rm -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":80 -it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像名称"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" /bin/bash\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("容器的启动与停止")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动一个容器")]),s._v("\ndocker container start "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器ID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止一个容器")]),s._v("\ndocker container stop "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器ID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除容器文件")]),s._v("\ndocker container "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器ID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 终止一个容器")]),s._v("\ndocker container "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器ID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h2",{attrs:{id:"dockerfile"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[s._v("#")]),s._v(" Dockerfile")]),s._v(" "),n("p",[s._v("如何编写 dockerfile 文件")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("FROM node:8.0\nCOPY "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" /app\nWORKDIR /app\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\nEXPOSE "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")]),s._v("\nCMD node app/index.js\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("Dockerfile 语法解析：")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("FROM node:80")]),s._v(": 继承官方的 node 镜像")]),s._v(" "),n("li",[n("code",[s._v("COPY . /app")]),s._v(": 将当前目录所有内容复制到镜像中的 app 目录下（如果没有 app 文件夹会自动创建）")]),s._v(" "),n("li",[n("code",[s._v("WORKDIR /app")]),s._v(": 指定接下来的工作路径为 /app")]),s._v(" "),n("li",[n("code",[s._v("RUN npm install")]),s._v(": 在 /app 目录下执行 npm install 命令")]),s._v(" "),n("li",[n("code",[s._v("EXPOSE 3000")]),s._v(": 将容器 3000 端口暴露出来，允许外部连接")]),s._v(" "),n("li",[n("code",[s._v("CMD node app/index.js")]),s._v("： 执行 node app/index.js 启动服务")])]),s._v(" "),n("p",[s._v("总结：拉取 node 镜像，然后将当前目录文件拷贝到容器的 "),n("code",[s._v("/app")]),s._v(" 路径下，\n并且指定接下来的工作路径为 "),n("code",[s._v("/app")]),s._v(", 然后运行 "),n("code",[s._v("npm")]),s._v(" 命令，安装依赖，然后暴露出 "),n("code",[s._v("3000")]),s._v(" 端口，\n最后启动 node 服务，这样外界就可以通过 "),n("code",[s._v("http://localhost:3000")]),s._v(" 访问容器里的 node 服务的内容了")]),s._v(" "),n("h3",{attrs:{id:"run-命令-cmd-的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#run-命令-cmd-的区别"}},[s._v("#")]),s._v(" RUN 命令 CMD 的区别")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("RUN")]),s._v(" 命令在镜像文件构建阶段执行，执行的结果会打包进入进镜像文件；")]),s._v(" "),n("li",[n("code",[s._v("CMD")]),s._v(" 命令则是在容器启动后执行")])]),s._v(" "),n("p",[s._v("一个 "),n("code",[s._v("Dockerfile")]),s._v(" 可以包含多个 "),n("code",[s._v("RUN")]),s._v(" 命令，但是只能有一个 "),n("code",[s._v("CMD")]),s._v(" 命令")]),s._v(" "),n("blockquote",[n("p",[s._v("如果指定了 "),n("code",[s._v("CMD")]),s._v(" 命令，那么在 "),n("code",[s._v("docker container run")]),s._v(" 后面就不能再附加命令了，比如前面的 "),n("code",[s._v("/bin/bash")]),s._v(", 否则会覆盖 "),n("code",[s._v("CMD")]),s._v(" 命令")])]),s._v(" "),n("h2",{attrs:{id:"其他"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[s._v("#")]),s._v(" 其他")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看日志")]),s._v("\ndocker container logs "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器ID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入正在运行的容器")]),s._v("\ndocker container "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器ID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" /bin/bash\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将容器里的文件拷贝到本机")]),s._v("\ndocker container "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器ID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("文件路径"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("本机地址"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);